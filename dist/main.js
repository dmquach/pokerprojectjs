!function(){"use strict";!function(){const t={1:"No Pair",2:"One Pair",3:"Two Pair",4:"Three of a Kind",5:"Straight",6:"Flush",7:"Full House!",8:"Four of a Kind!!",9:"Straight Flush!!!",10:"ROYAL FLUSH!!!"};function e(t){this.boardPos={"p1-1":"open","p1-2":"open","p1-3":"open","p1-4":"open","p2-1":"open","p2-2":"open","p2-3":"open","p2-4":"open","p3-1":"","p3-2":"","p3-3":"","p3-4":"","p4-1":"","p4-2":"","p4-3":"","p4-4":"","p5-1":"","p5-2":"","p5-3":"","p5-4":"","p6-1":"","p6-2":"","p6-3":"","p6-4":"",board1:"open",board2:"open",board3:"open",board4:"open",board5:"open",highlight:"p1-1"},this.deck=t,this.onBoard=[],this.winner=!1,this.addClickBoard(),this.createReset(),this._initialBorder()}e.prototype.addClickBoard=function(){for(let t in this.boardPos)"highlight"!==t&&document.getElementById(t).addEventListener("click",(t=>{"open"===this.boardPos[t.target.id]?(this._removeBorder(),this._addBorder(t.target)):""!==this.boardPos[t.target.id]?(this.winner&&this._clearWinnerBorders(),this.removeFromBoard(t.target.id),this._addBorder(t.target)):console.log("add player first!")}))},e.prototype.full=function(){return 5===this.onBoard.length},e.prototype.playersReady=function(){for(let t=1;t<7;t++){const e=this.deck[`p${t}`];if(e.active&&!e.handFull())return!1}return!0},e.prototype._countPlayers=function(){let t=0;for(let e=1;e<7;e++)this.deck[`p${e}`].active&&t++;return t},e.prototype.swapImg=function(t,e){const o=document.getElementById(t),i=o.src,s=document.getElementById(e);o.src=s.src,s.src=i},e.prototype.pushOnBoard=function(t){this.onBoard.push(t)},e.prototype.createReset=function(){document.getElementById("resetButton").addEventListener("click",(()=>{for(let t=1;t<7;t++)this.deck[`p${t}`].active&&this._removePlayers(`p${t}`),t<3&&this._addPlayers(`p${t}`);this.clearBoard(),this._createNextBorder()}))},e.prototype.addToBoard=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;""===this.boardPos.highlight?console.log("everything full"):(this.boardPos[this.boardPos.highlight]="taken",this.deck.cardDeck[t]="board",this.swapImg(this.boardPos.highlight,t),"b"===this.boardPos.highlight[0]&&this.pushOnBoard(t),this.full()&&this.playersReady()?this.highlightWinner():this.playersReady()?await this.displayEquities(this.onBoard):this.createWaitingMessages(),this._createNextBorder(e))},e.prototype.removeFromBoard=async function(t){const e=document.getElementById(t),o=this.changeSrcToId(e.src);this.swapImg(t,o),this.boardPos[t]="open",this.deck.cardDeck[o]="deck";const i=this.onBoard.indexOf(o);-1!==i&&this.onBoard.splice(i,1);for(let t=1;t<7;t++){let e=this.deck[`p${t}`].playerHand,i=e.indexOf(o);-1!==i&&e.splice(i,1)}this.full()&&this.playersReady()?this.highlightWinner():this.playersReady()?await this.displayEquities(this.onBoard):this.createWaitingMessages()},e.prototype.clearBoard=function(){for(let t=1;t<6;t++)"taken"===this.boardPos[`board${t}`]&&this.removeFromBoard(`board${t}`);this._clearWinnerBorders()},e.prototype._calculateBestHands=function(){const t={};for(let e=1;e<7;e++)this.deck[`p${e}`].handFull()&&(t[`p${e}`]=this.deck.handtype.bestHand(this.deck[`p${e}`].playerHand,this.onBoard));return t},e.prototype._addBorder=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-2;return t&&t.id||(t=document.getElementById(t)),["board1","board2","board3"].includes(t.id)?(this._removeBorder(),this.boardPos.highlight=t.id,document.getElementById("board1").style.border="2px solid red",document.getElementById("board2").style.border="2px solid red",document.getElementById("board3").style.border="2px solid red"):(this._removeBorder(),this.boardPos.highlight=t.id,t.style.border="2px solid red")},e.prototype._removeBorder=function(){const t=document.getElementById(this.boardPos.highlight);t&&["board1","board2","board3"].includes(t.id)&&(document.getElementById("board1").removeAttribute("style"),document.getElementById("board2").removeAttribute("style"),document.getElementById("board3").removeAttribute("style")),t&&"4px solid blue"!==t.style.border&&t.removeAttribute("style"),this.boardPos.highlight=""},e.prototype._clearWinnerBorders=function(){for(let t in this.boardPos){const e=document.getElementById(t);e&&e.removeAttribute("style")}},e.prototype._findNextBorder=function(){for(let t in this.boardPos)if("open"===this.boardPos[t]){const e=document.getElementById(t);return this._addBorder(e)}return this.highlightWinner()},e.prototype._createNextBorder=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(-1===t&&this.full())return this._findNextBorder();if(t>0&&4===this.deck["p"+t].handLength())return this._findNextBorder();if(-1===t){for(let t in this.boardPos)if("b"===t[0]&&"open"===this.boardPos[t]){const e=document.getElementById(t);return this._addBorder(e)}}else{if(0===t)return this._findNextBorder();for(let e in this.boardPos)if(Number(e[1])===t&&"open"===this.boardPos[e]){const t=document.getElementById(e);return this._addBorder(t)}}},e.prototype._createNewPlayerBorder=function(t){const e=document.getElementById(`${t}-1`);this._addBorder(e)},e.prototype._initialBorder=function(){const t=document.getElementById("p1-1");this._addBorder(t)},e.prototype._getHighlightedPos=function(){const t=this.boardPos.highlight;return"p"===t[0]?t.slice(0,2):-1},e.prototype._addPlayers=function(t){for(let e in this.boardPos)e[1]===t[1]&&(document.querySelector(`.${e}`).classList.remove("blur"),this.boardPos[e]="open");const e=document.getElementById(t),o=e.childNodes[2];e.querySelector("img").src="./images/icons8-minus-50.png",o.nodeValue+=" equity: "},e.prototype._removePlayers=function(t){for(let e in this.boardPos)e[1]===t[1]&&(document.querySelector(`.${e}`).classList.add("blur"),"open"!==this.boardPos[e]&&this.removeFromBoard(e),this.boardPos[e]="",this._createNextBorder());const e=document.getElementById(t),o=e.childNodes[2];e.querySelector("img").src="./images/icons8-plus-button-50.png",o.nodeValue=`P${t[1]}`},e.prototype.changeSrcToId=function(t){let e,o,i;return t.includes("spades")?(i="s",o=t.slice(-16)):t.includes("diamonds")?(i="d",o=t.slice(-18)):t.includes("hearts")?(i="h",o=t.slice(-16)):t.includes("clubs")&&(i="c",o=t.slice(-15)),!!o&&(o.includes("2")?e="2":o.includes("3")?e="3":o.includes("4")?e="4":o.includes("5")?e="5":o.includes("6")?e="6":o.includes("7")?e="7":o.includes("8")?e="8":o.includes("9")?e="9":o.includes("10")?e="10":o.includes("J")?e="J":o.includes("Q")?e="Q":o.includes("K")?e="K":o.includes("A")&&(e="A"),`${e}${i}`)},e.prototype.changeIdToSrc=function(t){let e,o,i;return 2==t.length?(e=t[0],o=t[1]):(e=10,o=t[2]),"c"==o?i="clubs":"d"==o?i="diamonds":"s"==o?i="spades":"h"==o&&(i="hearts"),`./images/${e}_of_${i}.png`},e.prototype.highlightWinner=function(){if(!this.full()||!this.playersReady())return-1;this._removeBorder(),this.boardPos.highlight="",this.winner=!0;const e=this._calculateBestHands(),o=this.deck.handtype.winner(e),i=Object.keys(o);let s=[];for(let n=1;n<7;n++){const r=`p${n}`;if(i.includes(r)){const e=o[r][0],i=t[e];s=s.concat(o[r][1].filter((t=>!s.includes(t)))),document.getElementById(r).childNodes[2].nodeValue=`WINNER: ${i}`}else this.deck[r].active&&(document.getElementById(r).childNodes[2].nodeValue=`${t[e[r][0]]}`)}document.querySelectorAll("img").forEach((t=>{const e=this.changeSrcToId(t.src);-1!==s.indexOf(e)&&(t.style.border="4px solid blue")}))},e.prototype.createWaitingMessages=function(){for(let t=1;t<7;t++)this.deck[`p${t}`].active&&(document.getElementById(`p${t}`).childNodes[2].nodeValue="Waiting on unfilled hands")},e.prototype.displayEquities=async function(t){if(!this.playersReady()||0===this._countPlayers())return-1;if(4===this.onBoard.length||3===this.onBoard.length||0===this.onBoard.length){const e=document.getElementById("loading-screen");e&&(e.style.display="flex"),setTimeout((async()=>{const o=await this.deck.handtype.equities(t);for(const t in o[0])document.getElementById(t).childNodes[2].nodeValue=`${t} equity: ${(o[0][t][0]/o[1]*100).toFixed(2)}%`;e&&(e.style.display="none")}),0)}};const o={A:14,K:13,Q:12,J:11,10:10,1:10,9:9,8:8,7:7,6:6,5:5,4:4,3:3,2:2};function i(t,e,o,i,s,n,r){this.p1=t,this.p2=e,this.p3=o,this.p4=i,this.p5=s,this.p6=n,this.deck=r}function s(t,o,s,n,r,d){this.cardDeck={"2c":"deck","3c":"deck","4c":"deck","5c":"deck","6c":"deck","7c":"deck","8c":"deck","9c":"deck","10c":"deck",Jc:"deck",Qc:"deck",Kc:"deck",Ac:"deck","2d":"deck","3d":"deck","4d":"deck","5d":"deck","6d":"deck","7d":"deck","8d":"deck","9d":"deck","10d":"deck",Jd:"deck",Qd:"deck",Kd:"deck",Ad:"deck","2s":"deck","3s":"deck","4s":"deck","5s":"deck","6s":"deck","7s":"deck","8s":"deck","9s":"deck","10s":"deck",Js:"deck",Qs:"deck",Ks:"deck",As:"deck","2h":"deck","3h":"deck","4h":"deck","5h":"deck","6h":"deck","7h":"deck","8h":"deck","9h":"deck","10h":"deck",Jh:"deck",Qh:"deck",Kh:"deck",Ah:"deck"},this.board=new e(this),this.p1=t,this.p2=o,this.p3=s,this.p4=n,this.p5=r,this.p6=d,this.addClickCards(),this.handtype=new i(this.p1,this.p2,this.p3,this.p4,this.p5,this.p6,this)}function n(t,e){this.playerHand=[],this.playerNum=e,this.active=t}function r(){this.p1=new n(!0,"p1"),this.p2=new n(!0,"p2"),this.p3=new n(!1,"p3"),this.p4=new n(!1,"p4"),this.p5=new n(!1,"p5"),this.p6=new n(!1,"p6"),this.deck=new s(this.p1,this.p2,this.p3,this.p4,this.p5,this.p6),this.addDeckToPlayer(this.deck)}i.prototype.isFlush=function(t){const e=t[0].slice(-1);for(let o=0;o<5;o++)if(t[o].slice(-1)!==e)return!1;return[!0,this.sortHand(t)]},i.prototype.isStraight=function(t){let e=[];const o=this.sortHand(t);for(let t=0;t<5;t++)e.push(o[t][0]);return(JSON.stringify(e)==JSON.stringify(["A","5","4","3","2"])||JSON.stringify(e)==JSON.stringify(["6","5","4","3","2"])||JSON.stringify(e)==JSON.stringify(["7","6","5","4","3"])||JSON.stringify(e)==JSON.stringify(["8","7","6","5","4"])||JSON.stringify(e)==JSON.stringify(["9","8","7","6","5"])||JSON.stringify(e)==JSON.stringify(["1","9","8","7","6"])||JSON.stringify(e)==JSON.stringify(["J","1","9","8","7"])||JSON.stringify(e)==JSON.stringify(["Q","J","1","9","8"])||JSON.stringify(e)==JSON.stringify(["K","Q","J","1","9"])||JSON.stringify(e)==JSON.stringify(["A","K","Q","J","1"]))&&[!0,o]},i.prototype.isFourOfAKind=function(t){let e=0;const o=this.sortHand(t);let i=o[0][0];o[0][0]!==o[1][0]&&(i=o[1][0]);for(let t=0;t<o.length;t++)o[t][0]==i&&(e+=1);return 4===e&&[!0,o]},i.prototype.isFullHouse=function(t){const e=this.sortHand(t);return(e[0][0]===e[1][0]&&e[1][0]===e[2][0]&&e[3][0]===e[4][0]||e[0][0]===e[1][0]&&e[2][0]===e[3][0]&&e[3][0]===e[4][0])&&[!0,e]},i.prototype.isThreeOfAKind=function(t){const e=this.sortHand(t);return(e[0][0]===e[1][0]&&e[1][0]==e[2][0]||e[1][0]===e[2][0]&&e[2][0]==e[3][0]||e[2][0]===e[3][0]&&e[3][0]==e[4][0])&&[!0,e]},i.prototype.isTwoPair=function(t){const e=this.sortHand(t);return(e[0][0]===e[1][0]&&e[2][0]===e[3][0]||e[0][0]===e[1][0]&&e[3][0]===e[4][0]||e[1][0]===e[2][0]&&e[3][0]===e[4][0])&&[!0,e]},i.prototype.isOnePair=function(t){const e=this.sortHand(t);return(e[0][0]===e[1][0]||e[1][0]===e[2][0]||e[2][0]===e[3][0]||e[3][0]===e[4][0])&&[!0,e]},i.prototype.isNoPair=function(t){const e=this.sortHand(t);return e[0][0]!==e[1][0]&&e[1][0]!==e[2][0]&&e[2][0]!==e[3][0]&&e[3][0]!==e[4][0]&&[!0,e]},i.prototype.broadway=function(t){return t.sort(),"10"===t[0].slice(0,2)&&"A"===t[1].slice(0,1)&&"J"===t[2].slice(0,1)&&"K"===t[3].slice(0,1)&&"Q"===t[4].slice(0,1)},i.prototype.sortHand=function(t){t.sort(((t,e)=>{const i=o[t.slice(0,-1)];return o[e.slice(0,-1)]-i}));const e={},i=[];return t.forEach((t=>{e[t[0]]=(e[t[0]]||0)+1})),t.forEach((t=>{e[t[0]]>=3&&i.push(t)})),t.forEach((t=>{2===e[t[0]]&&i.push(t)})),t.forEach((t=>{i.includes(t)||i.push(t)})),i},i.prototype.getPokerHand=function(t){const e=this.isFlush(t),o=this.isStraight(t);if(e[0]&&o[0])return this.broadway(t)?[10,this.sortHand(t)]:[9,this.sortHand(t)];const i=this.isFourOfAKind(t);if(i[0])return[8,i[1]];const s=this.isFullHouse(t);if(s[0])return[7,s[1]];const n=this.isFlush(t);if(n[0])return[6,n[1]];const r=this.isStraight(t);if(r[0])return[5,r[1]];const d=this.isThreeOfAKind(t);if(d[0])return[4,d[1]];const c=this.isTwoPair(t);if(c[0])return[3,c[1]];const h=this.isOnePair(t);if(h[0])return[2,h[1]];const a=this.isNoPair(t);return a[0]?[1,a[1]]:void 0},i.prototype.bestHand=function(t,e){const o=[],i=[];for(let e=0;e<t.length-1;e++)for(let i=e+1;i<t.length;i++)o.push([t[e],t[i]]);for(let t=0;t<e.length-2;t++)for(let o=t+1;o<e.length-1;o++)for(let s=o+1;s<e.length;s++){const n=[e[t],e[o],e[s]];i.push(n)}let s=[0];for(let t=0;t<i.length;t++)for(let e=0;e<o.length;e++){const n=this.getPokerHand([o[e][0],o[e][1],i[t][0],i[t][1],i[t][2]]);if(n[0]>s[0])s=n;else if(n[0]===s[0]){const t=this.comparingKickers(n[1],s[1]);0!==t&&(s=[n[0],t[1]])}}return s},i.prototype.comparingKickers=function(t,e){if("A"===t[0][0]||"A"===e[0][0])return"A"===t[0][0]&&"A"===e[0][0]?0:"A"===t[0][0]?[2,e]:[1,t];for(let i=0;i<5;i++){if(o[t[i][0]]>o[e[i][0]])return[1,t];if(o[t[i][0]]<o[e[i][0]])return[2,e]}return 0},i.prototype.activeHands=function(){const t={};for(let e=1;e<6;e++)this[`p${e}`].active&&(t[`p${e}`]=[0,[this[`p${e}`].playerHand]]);return t},i.prototype.equitiesPreFlop=function(t,e,o,i){for(let i=0;i<2500;i++){const i=this.deck.dealCards(e,5),s={};for(let t=1;t<7;t++)this.deck[`p${t}`].handFull()&&(s[`p${t}`]=this.bestHand(this.deck[`p${t}`].playerHand,i));const n=this.winner(s),r=Object.keys(n);r.length>1||(t[r[0]][0]+=1),o++}return[t,o]},i.prototype.equitiesTwoMoreCards=function(t,e,o,i,s,n){for(let s=n;s<o.length;s++)for(let n=s+1;n<o.length;n++){const r={};for(let e=1;e<7;e++)this.deck[`p${e}`].handFull()&&(r[`p${e}`]=this.bestHand(this.deck[`p${e}`].playerHand,t.concat([o[s],o[n]])));const d=this.winner(r),c=Object.keys(d);c.length>1||(e[c[0]][0]+=1),i+=1}return[e,i]},i.prototype.equitiesOneMoreCard=function(t,e,o,i,s,n){for(let s=n;s<o.length;s++){const n={};for(let e=1;e<7;e++)this.deck[`p${e}`].handFull()&&(n[`p${e}`]=this.bestHand(this.deck[`p${e}`].playerHand,t.concat(o[s])));const r=this.winner(n),d=Object.keys(r);d.length>1||(e[d[0]][0]+=1),i+=1}return[e,i]},i.prototype.winner=function(t){if(0===Object.keys(t).length)return!1;let e={empty:[0,[]]};for(let o in t){const i=e[Object.keys(e)[0]];if(t[o][0]>i[0])e={},e[o]=t[o];else if(t[o][0]===i[0]){const s=this.comparingKickers(t[o][1],i[1]);0===s?e[o]=[t[o][0],t[o][1]]:1===s[0]&&(e={},e[o]=t[o])}}return e},i.prototype.equities=async function(t){const e=document.getElementById("loading-screen");e&&(e.style.display="flex"),await new Promise((t=>setTimeout(t,200)));const o=this.activeHands(),i=this.deck.inDeck();let s=-1;return 0===t.length?(console.log("no cards on board"),s=this.equitiesPreFlop(o,i,0,0)):1===t.length||2===t.length?console.log("finish flop"):3===t.length?(console.log("three cards on board"),s=this.equitiesTwoMoreCards(t,o,i,0,0,0)):4===t.length&&(console.log("four cards on board"),s=this.equitiesOneMoreCard(t,o,i,0,0,0)),e&&(e.style.display="none"),s},s.prototype.lastPlayerAdded=function(t){this.lastPlayer=t},s.prototype.addClickCards=function(){for(let t in this.cardDeck){const e=document.getElementById(t);e.addEventListener("click",(()=>{if("deck"===this.cardDeck[e.id]){const t=this.board._getHighlightedPos();-1!==t?(this[t].addToHand(e.id),this.lastPlayer=t,this.board.addToBoard(e.id,Number(t[1]))):this.board.addToBoard(e.id,-1)}else console.log("not in deck")}))}},s.prototype.inDeck=function(){const t=[];for(const e in this.cardDeck)"deck"===this.cardDeck[e]&&t.push(e);return t},s.prototype.dealCards=function(t,e){for(let e=t.length-1;e>0;e--){const o=Math.floor(Math.random()*(e+1));[t[e],t[o]]=[t[o],t[e]]}return t.slice(0,e)},n.prototype.setDeck=function(t){this.deck=t,this.addAndRemovePlayerButton()},n.prototype.activate=function(){this.active=!this.active},n.prototype.handLength=function(){return this.playerHand.length},n.prototype.addAndRemovePlayerButton=function(){document.getElementById(this.playerNum).addEventListener("click",(()=>{this.active?(this.activate(),this.deck.board._removePlayers(this.playerNum),this.deck.board._createNextBorder(),this.deck.board._clearWinnerBorders(),this.deck.board.highlightWinner(),this.deck.board._createNextBorder()):(this.activate(),this.deck.board._addPlayers(this.playerNum),this.deck.board._createNewPlayerBorder(this.playerNum),this.deck.board._clearWinnerBorders(),this.deck.board._addBorder(`${this.playerNum}-1`),this.deck.board.createWaitingMessages())}))},n.prototype.addToHand=function(t){this.playerHand.push(t)},n.prototype.removeFromHand=function(t){this.playerHand.push(t)},n.prototype.handFull=function(){return 4===this.playerHand.length},r.prototype.addDeckToPlayer=function(t){this.p1.setDeck(t),this.p2.setDeck(t),this.p3.setDeck(t),this.p4.setDeck(t),this.p5.setDeck(t),this.p6.setDeck(t)},window.addEventListener("DOMContentLoaded",(()=>{const t=document.getElementById("loading-screen");t&&(t.style.display="none")})),new r}()}();
//# sourceMappingURL=main.js.map